---
id: layout_container
title: Layout Container
sidebar_label: Layout Container
---

<!--
WARNING: this file was automatically generated by Mia-Platform Doc Aggregator.
DO NOT MODIFY IT BY HAND.
Instead, modify the source file and run the aggregator to regenerate this file.
-->

<!--
WARNING:
This file is automatically generated. Please edit the 'README' file of the corresponding component and run `yarn copy:docs`
-->

[element-composer]: https://micro-lc.io/1.x/docs/core_plugins/#microlc-element-composer
[shadow dom]: https://developer.mozilla.org/en-US/docs/Web/API/Web_components/Using_shadow_DOM

[event-bus]: ../10_overview.md#events

[bk-button]: ./90_button.md
[bk-calendar]: ./130_calendar.md
[bk-tabs]: ./530_tabs.md
[bk-layout-swap]: ./410_layout_swap.md
[bk-crud-client]: ./100_crud_client.md

[layout/change]: ../70_events.md#layout---change



```html
<bk-layout-container></bk-layout-container>
```

:::caution
Using `@micro-lc/composer@^2` and `@micro-lc/orchestrator@^2` as rendering engine and micro-frontend orchestrator,
the [Layout Swap][bk-layout-swap] should be used instead of the Layout Container.
:::

This component is meant to allow multiple configurations to live within the same plugin by:

1. re-using `back-kit` components without letting functionalities (mostly clients') trump each other
2. render multiple layouts together like a page with table, then a card detail, then another table and so on
3. condensate plugins into a single one

A simple instance would be a user which might want to explore multiple details connected with its user but persisted on different entities.

Since a backend resource, like a database collection/table, is mostly mapped 1:1 on a Microfrontend Composer plugin using a single client, like the [CRUD Client][bk-crud-client], it is recommendable to use different plugins to render different collections.
For those cases falling outside the previous scope a layout that can be switched might come in handy.
<!-- For those cases falling outside the previous scope, for instance a customer which might want to check simultaneously both its purchases and its current shopping cart which,
if the latter is persisted, are definitively stored on different places, a layout that can be switched might come in handy. -->

By reproducing an [element-composer]-compatible configuration, the Layout Container provides a wrapper for different configurations wired to one or many [event-bus] instances.
Such configurations are switched whenever the Layout Container receives to the request of switching to a new layout, via a [layout/change] event.

## How to configure

The Layout Container should be provided with the `content` property, specifying the configurations of the layouts to orchestrate.

```json
{
  "tag": "bk-layout-container",
  "properties": {
    "content": {
      "$default": {
        ... // first plugin
      },
      "currentBasket": {
        ... // second plugin
      }
    }
  }
}
```

The `$default` key is not mandatory but is reserved and marks the layout to render on landing.
The Layout Container also allows to specify the default layout through property `currentLayout`.

### Event bus

Each layout has a dedicated [EventBus][event-bus] instance which has the same name of the configuration key.
This is by default injected to all components of the layout.

To configure this behavior the key `busDiscriminator` is available.

This defaults to `$inherit` and takes the `EventBus` of its parent. Specifying a different value spawns a new `EventBus`.

### Disable shadow dom

Adding the attribute `disable-shadow-dom` allows to disable the [shadow dom] for the Layout Container,
which can be useful when it has to embed children which bubble events up to the document root such as the [Calendar][bk-calendar].

:::caution
`disable-shadow-dom` needs be passed as an empty attribute to the Layout Container, and **not** as property. For instance:

```json
{
  "tag": "bk-layout-container",
  "attributes": {
    "disable-shadow-dom":""
  },
  "properties": {
    "content": {
      "$default": {
        ... // first plugin
      },
      "currentBasket": {
        ... // second plugin
      }
    }
  }
}
```
:::

## Examples

### Example: Merging two plugins into one

Let's then suppose we have a customer, a list of their previous purchases and a list of their current basket items.

We could use different plugins. For previous purchases it would look like:

```json
// previous-purchases.json
{
  "$ref": {
    "ppSchema": {
      "type": "object",
      "properties": {
        "_id": {"type": "string"},
        "items": {"type": "array"}
      }
    }
  },
  "content": {
    "type": "row",
    "content": [
      {
        "tag": "bk-table",
        "properties": {
          "dataSchema": {"$ref": "ppSchema"} 
        }
      },
      {
        "tag": "bk-crud-client",
        "properties": {
          "dataSchema": {"$ref": "ppSchema"} 
        }
      }
    ]
  }
}
```

while current basket would look like:

```json
// current-basket.json
{
  "$ref": {
    "cbSchema": {
      "type": "object",
      "properties": {
        "_id": {"type": "string"},
        "description": {"type": "string"},
        "price": {"type": "number"}
      }
    }
  },
  "content": {
    "type": "row",
    "content": [
      {
        "tag": "bk-table",
        "properties": {
          "dataSchema": {"$ref": "cbSchema"} 
        }
      },
      {
        "tag": "bk-crud-client",
        "properties": {
          "dataSchema": {"$ref": "cbSchema"} 
        }
      }
    ]
  }
}
```

If the UI should instead include two tables in a page that can be visually swapped by a set of buttons or tabs,
wrapping both configurations in the Layout Container does the job.

```json
// single-plugin.json
{
  "$ref": {
    "ppSchema": {
      "type": "object",
      "properties": {
        "_id": {"type": "string"},
        "items": {"type": "array"}
      }
    },
    "cbSchema": {
      "type": "object",
      "properties": {
        "_id": {"type": "string"},
        "description": {"type": "string"},
        "price": {"type": "number"}
      }
    }
  },
  "content": {
    "tag": "bk-layout-container",
    "properties": {
      "content": {
        "$default": {/* first plugin */},
        "currentBasket": {/* second plugin */}
      }
    }
  }
}
```

### Example: switch layout using a button

The [Button][bk-button] can be used to switch to a different layout:

```json
{
  "tag": "bk-button",
  "properties": {
    "content": "View Orders",
    "action": {
      "type": "event",
      "config": {
        "label": "layout/change",
        "payload": {
          "layout": "orders"
        }
      }
    }
  }
},
{
  "tag": "bk-button",
  "properties": {
    "content": "View Riders",
    "action": {
      "type": "event",
      "config": {
        "label": "layout/change",
        "payload": {
          "layout": "riders"
        }
      }
    }
  }
},
{
  "tag": "bk-layout-container",
  "properties": {
    "content": {
      "riders": {...},
      "orders": {...}
    }
  }
}
```

### Example: switch layout using tabs

The [Tabs][bk-tabs] can be used to navigate between layouts:

```json
{
  "tag": "bk-tabs",
  "properties": {
    "tabs": [
      {
        "key": "riders",
        "title": "Riders",
        "event": {
          "label": "layout/change",
          "payload": {
            "layout": "riders"
          }
        }
      },
      {
        "key": "customers",
        "title": "Customers",
        "event": {
          "label": "layout/change",
          "payload": {
            "layout": "customers"
          }
        }
      }
    ]
  }
},
{
  "tag": "bk-layout-container",
  "properties": {
    "content": {
      "riders": {...},
      "orders": {...}
    }
  }
}
```

## API

### Properties & Attributes

| property           | attribute            | type                | default | description                                                         |
| ------------------ | -------------------- | ------------------- | ------- | ------------------------------------------------------------------- |
| `content`          | -                    | [Content](#content) | -       | layouts configuration                                               |
| `disableShadowDom` | `disable-shadow-dom` | boolean             | false   | disable the shadow dom as render root (only use as empty attribute) |
| `currentLayout`    | `current-layout`     | string              | -       | default layout to view on landing                                   |

#### Content
```typescript
type Content = Record<string, LayoutNode> | Record<string, LayoutNode[]>
type LayoutNode = {
  attributes?: Record<string, string>
  busDiscriminator?: string | string[]
  content?: LayoutNode | LayoutNode[]
  properties?: Record<string, any>
  tag?: string
  type?: string
}
```

### Listens to

| event           | action                                                                         |
| --------------- | ------------------------------------------------------------------------------ |
| [layout/change] | requires the connection of the layout which is referenced in the event payload |

### Emits

None
