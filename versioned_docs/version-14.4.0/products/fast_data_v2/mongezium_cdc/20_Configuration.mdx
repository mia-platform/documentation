---
id: configuration
title: Configuration
sidebar_label: Configuration
---

import MongeziumSchema from "@site/static/schemas/fast_data/mongezium.0.4.3.schema.json"
import MongeziumConfigExample from "@site/static/schemas/fast_data/examples/mongezium.example.json"
import SchemaViewer from "@site/src/components/SchemaViewer"

In order to configure the service, a set of environment variables are adopted for
describing basic service needs, alongside a main configuration file.

## Environment Variables

| Variable                    | Description                                                                                                                | Default                |
|-----------------------------|----------------------------------------------------------------------------------------------------------------------------|------------------------|
| LOG_LEVEL                   | the maximum log level to emit. Accepted levels are  `trace`\|`debug`\|`info`\|`warn`\|`error`                              | `info`                 |
| HTTP_PORT                   | the HTTP port on which kubernetes status routes and metrics are exposed                                                    | `3000`                 |
| CONFIGURATION_FOLDER        | the filepath to the folder under which configuration file is located                                                       | `<HOME>/.df/mongezium` |
| OTEL_EXPORTER_OTLP_ENDPOINT | specify the OpenTelemetry OTLP endpoint where traces and metrics should be pushed. When not set, telemetry is not exported |                        |

:::info

Currently `<HOME>` value is set to `/home/mongezium`, which is based on how the service image is built.

:::

## Configuration File

The application needs a configuration file, named `config.json`, which respects 
the following JSON schema configuration.

<SchemaViewer schema={MongeziumSchema} example={MongeziumConfigExample} />

Starting from version _v0.4.3_, the Mongezium configuration file supports a `connections` property.
This property allows you to create references to Kafka and MongoDB connections, which can then be reused within the `stream` and `persistence` properties, respectively.
This feature, already present in other Fast Data services like [Stream Processor](/products/fast_data_v2/stream_processor/10_Overview.md),
[Farm Data](/products/fast_data_v2/farm_data/10_Overview.md), and [Kango](/products/fast_data_v2/kango/10_Overview.md),
simplifies the configuration file by eliminating the need to repeat connection details.

:::warning

Although you can currently define Kafka or MongoDB connections either within the `connections` property or directly in their respective configuration sections, please be aware that support for the latter is deprecated.

Future versions of Mongezium will exclusively support connection definitions inside the `connections` property. Therefore, it is highly recommended to adopt this approach as soon as you upgrade to Mongezium _v0.4.3_ or a later version.

:::

In addition, Kafka configurations and MongoDB persistence properties support [**secret resolution**](/products/fast_data_v2/secrets_resolution.md).

:::note

The raw JSON schema can also be found <a target="_blank" href="/schemas/fast_data/mongezium.0.4.3.schema.json">here</a>.

:::

## Kubernetes

### Resources

When the plugin is deployed on Kubernetes, it is advised to set its resources
_requests_ and _limits_. Here are provided which are the recommended ones, although
they can be changed according to your needs:

#### Recommended

- _requests_:
  ```text
  CPU: 250m 
  Memory: 50MB
  ```
- _limits_:
  ```text
  CPU: 1000m 
  Memory: 150MB
  ```

### Status Probes

The service exposes the `liveness` and `readines` status probes as HTTP endpoint, which
helps Kubernetes when the service is successfully started and when it may need to be restarted.

The endpoints are:

- `liveness` probe: `/-/healthz`
- `readiness` probe: `/-/ready`
