---
id: file_manager
title: File Manager
sidebar_label: File Manager
---

<!--
WARNING: this file was automatically generated by Mia-Platform Doc Aggregator.
DO NOT MODIFY IT BY HAND.
Instead, modify the source file and run the aggregator to regenerate this file.
-->

<!--
WARNING:
This file is automatically generated. Please edit the 'README' file of the corresponding component and run `yarn copy:docs`
-->


[files-service]: /runtime_suite/files-service/configuration.mdx
[crud-service]: /runtime_suite/crud-service/10_overview_and_usage.md

[bk-file-client]: ./280_file_service_client.md
[bk-crud-client]: ./100_crud_client.md

[file-management]: ../80_examples/30_plugin_navigation.md

[update-data-with-file]: ../70_events.md#update-data-with-file
[create-data-with-file]: ../70_events.md#create-data-with-file
[upload-file]: ../70_events.md#upload-file
[uploaded-file]: ../70_events.md#uploaded-file
[update-data]: ../70_events.md#update-data
[create-data]: ../70_events.md#create-data
[delete-file]: ../70_events.md#delete-file
[error]: ../70_events.md#error




```html
<bk-file-manager></bk-file-manager>
```

Manages file upload transactions by holding a unique transaction ID hash map. Since files are often linked to a collection entry but stored on a different service, it might be handy to control file upload through a transaction manager. Two steps are needed to successfully upload a file:

1. handle file uploads to a storage service. Assuming a backend service such as [Mia Platform's Files Service][files-service], a component like the [File Service Client][bk-file-client] could perform such task.
2. handle updates to the CRUD collection. Assuming a backend service such as [Mia Platform's CRUD Service][crud-service], this task could be handled by the [CRUD Client][bk-crud-client].

The File Manager component processes requests originating from other components to create or update data in a CRUD collection, which also require operations involving uploading files to a designated file storage service. The requests that trigger these actions are typically in the form of [create-data-with-file] or [update-data-with-file] events.

These events encapsulate both the data to be created or updated and additional information within their meta section. The meta data aids in extracting the files that require uploading from the payload.

The flow of this process can be summarized as follows:

- The File Manager identifies within the payload all files that should be uploaded.
- For each identified file, the File Manager initiates an upload request to the designated file storage service.
- Upon receiving notifications confirming successful file uploads, the File Manager proceeds to signal the request for creating or updating data using the complete payload from the initial triggering event.
- However, in the event of an error notification being received, the entire transaction is retracted. This includes deleting any files that were already uploaded as part of the incomplete transaction.

Further details on how Back-Kit components can be composed to handle file fields are available in the [specific section][file-management].

## How to configure

The File Manger does not require any configuration.

```json
{
  "tag": "bk-file-manager"
}
```

## API

### Properties & Attributes

None

### Listens to

| event | action | emits | on error |
|-------|--------|-------|----------|
|[update-data-with-file]|initiates an upload file transaction attaching a unique ID and attempting upload file to the storage service|[upload-file]| - |
|[create-data-with-file]|initiates an upload file transaction attaching a unique ID and attempting upload file to the storage service|[upload-file]| - |
|[uploaded-file]|continues a `create-data-with-file` or `update-data-with-file` transaction by patching the CRUD collection with the `upload-file` metadata|[update-data],[create-data]| - |
|[error]|interrupts a registered transaction due to an occurred `error` event carrying a `meta`. If the file was stored but the collection wasn't successfully patched, then the file is deleted|[delete-file]| - |

### Emits

| event         | description                                                                                                         |
| ------------- | ------------------------------------------------------------------------------------------------------------------- |
| [upload-file] | contains file and metadata to be stored                                                                             |
| [update-data] | after storage, contains reference metadata used to patch a collection containing reference to such file             |
| [create-data] | after storage, contains reference metadata used to create an item into collection containing reference to such file |
| [create-data] | after storage, contains reference metadata used to create an item into collection containing reference to such file |
| [delete-file] | contains file metadata to trigger file deletion                                                                     |
