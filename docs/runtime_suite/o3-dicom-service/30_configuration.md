---
id: configuration
title: Configuration
sidebar_label: Configuration
---

<!--
WARNING: this file was automatically generated by Mia-Platform Doc Aggregator.
DO NOT MODIFY IT BY HAND.
Instead, modify the source file and run the aggregator to regenerate this file.
-->

The DICOM Service needs some basic configurations in order to work properly. In particular, it requires:
* A configuration for the interaction with the PACS
* A configuration for the supporting data collections

## PACS
The DICOM Service allows you to interact with PACS. The service must be configured with the following environment variables in order to interact properly with the target PACS:
* `PACS_SERVICE_URL` (`required`): the URL to the PACS;
* `PACS_WORKITEM_CREATION_ENDPOINT`: the endpoint for the workitem creation;
* `PACS_WORKITEM_DELETION_ENDPOINT`: the endpoint for the workitem deletion;
* `PACS_WORKITEM_RETRIEVAL_ENDPOINT`: the endpoint for retrieving workitems;
* `PACS_EXAMS_RETRIEVING_ENDPOINT`: the endpoint for retrieving exams;
* `PACS_POST_EXAM_ENDPOINT` (`required`): the endpoint for posting exams;
* `PACS_AUTHORIZATION_TOKEN` (`required`): the Authorization token to be used in the PACS authentication; 
* `VIEWER_AUTHORIZATION_TOKEN` (`required`): the Authorization token to be used in the Viewer authentication;
* `DICOM_VIEWER_URL` (`required`): the URL to the DICOM Viewer, that will be used to generate the token for the visualization;
* `VIEWER_GET_TOKEN_ENDPOINT` (`required`): the DICOM Viewer endpoint responsible for generating visualization tokens;
* `DICOM_UID_ROOT` (`required`): the root of the UID generation;
* `CALLBACK_URLS`: comma-separated list of urls for proxying events.

## Supporting Data Collection
The DICOM Service needs a set of supporting data collections, based on the feature the service provides.

### UIDs collection
The DICOM Service allows you to generate unique identifiers (UIDs). The service must trace the generated UIDs in order to avoid the generation of duplicated UIDs. To do that, the service needs a CRUD Collection that keeps track of the generated UIDs, called `dcm_uid_registry`. It can be created in the *MongoDB CRUD* section of the *Mia-Platform Console*.

:::note
The name `dcm_uid_registry` used to refer to the generated UIDs collection can be modified by properly setting the related environment variables.  
:::

The `dcm_uid_registry` CRUD collection must contain the following fields:
* `uid` (type: `String`): The UID generated by the DICOM Service.

### New exams collection
The DICOM Service can be notified every time a new exam is uploaded to the related PACS. The event arriving from the PACS must be saved to the CRUD, in order to trace the exams which have not been uploaded with the DICOM Service. To do that, the service needs a CRUD Collection that keeps track of the arriving events, called `dcm-events-registry`. It can be created in the *MongoDB CRUD* section of the *Mia-Platform Console*.

:::note
The name `dcm_events_registry` used to refer to the generated UIDs collection can be modified by properly setting the related environment variables.  
:::

The `dcm_events_registry` CRUD collection must contain the following fields:
* `pacsEvent` (type: `Object`): The event arriving from the PACS.

### Environment Variables

Once the collections have been created, you have to configure the service via environment variables to tell the DICOM Service how to reach those collections. Specifically, you need to configure the variables: 
- `CRUD_SERVICE_URL`: it is the URL of the *CRUD-Service* that allows to access the created collections; by default, this is set to `http://crud-service/`;
- `DCM_UID_ENDPOINT`: it is the endpoint of the *CRUD-Service* at which the `dcm_uid_registry` collection is reachable; by default, this is set to `/dcm-uid-registry`;
- `DCM_EVENTS_ENDPOINT`: it is the endpoint of the *CRUD-Service* at which the `dcm_events_registry` collection is reachable; by default, this is set to `/dcm-events-registry`.
