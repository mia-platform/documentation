---
id: file_storage
title: File Storage Management
sidebar_label: File Storage
---

<!--
WARNING: this file was automatically generated by Mia-Platform Doc Aggregator.
DO NOT MODIFY IT BY HAND.
Instead, modify the source file and run the aggregator to regenerate this file.
-->

Mia-Platform Console requires a connection to a bucket where files can be stored, supported buckets are:

* MongoDB GridFS
* AWS S3 (and S3 compatible storages)
* Google Cloud Storage

You can configure the desired file storage with the `fileStorageType` configuration key with one of `mongodb`, `s3` or `googleStorage` (the default value is `mongodb`).

:::info
The bucket is named by default as `files-bucket`; if you want to change the bucket name set the `filesBucketName` configuration as desired.
:::

## MongoDB specific configurations

There are no specific configurations for MongoDB integration since the connection string is obtained via the `configurations.mongodbUrl` configuration value; more information can be found [here](./40_mongodb_configurations_and_encryption.md#mongodb-configuration).

## AWS S3 specific configurations

| Name | Type | Description | Default | Optional |
|:----:|:----:|:-----------:|:-------:|:--------:|
|`filesStorageS3Key`| string | The S3 key |  | ✅ |
|`filesStorageS3Secret`| string | The S3 secret |  | ✅ |
|`filesStorageS3Region`| string | The S3 region where the bucket is located |  | ✅ |
|`filesStorageS3Endpoint`| string | The S3 endpoint |  | ✅ |
|`filesStorageS3ForcePathStyle`| boolean | Whether to force path style URLs for S3 objects |  | ✅ |
|`filesStorageS3SignatureVersion`| string | The signature version to sign requests with |  | ✅ |

## Google Cloud Storage specific configurations

| Name | Type | Description | Default | Optional |
|:----:|:----:|:-----------:|:-------:|:--------:|
|`filesCredentials`| string | A stringified credentials file for conneting to the Google Storage bucket |  | ✅ |

## Examples

```yaml
mia-console:
  configurations:
    ...
    filesStorageType: "googleStorage"
    filesBucketName: "mia-console-files-bucket"
    filesCredentials: "{{GOOGLE_STORAGE_CREDENTIALS}}"
```

## Workload Identity

If you are using a cloud provided bucket storage from AWS or Google you can also use the Workload Identity authorization method.
You can use the `serviceAccount.annotations` property to setup the correct annotation for your cloud provider and follow their
guides for setting up the provider correctly.

* [GCP Workload Identity documentation]
* [AWS IAM roles for service accounts]

[GCP Workload Identity documentation]: https://cloud.google.com/kubernetes-engine/docs/how-to/workload-identity
[AWS IAM roles for service accounts]: https://docs.aws.amazon.com/eks/latest/userguide/iam-roles-for-service-accounts.html
